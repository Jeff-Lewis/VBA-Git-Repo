Option Explicit

Private Sub Application_NewMail()
'When a new email arrive mark unread deleted items as read
Dim namespace As Outlook.namespace
Dim unreadEmails As items
Dim item As Object
Dim i As Integer

    'Set the unreadEmails collection to the unread emails in the default trash folder
    Set namespace = Application.GetNamespace("MAPI")
    Set unreadEmails = namespace.GetDefaultFolder(olFolderDeletedItems).items.Restrict("[UnRead] = True")
    
    'Iterate through the emails in reverse and change the UnRead property to False
    For i = unreadEmails.Count To 1 Step -1
        unreadEmails(i).UnRead = False
    Next

    'Set the unreadEmails collection to the unread emails in the cases folder
    Set unreadEmails = namespace.folders("danseethaler@ldschurch.org").folders("Cases").items.Restrict("[UnRead] = True")
    
    'Iterate through the emails in reverse and change the UnRead property to False
    For i = unreadEmails.Count To 1 Step -1
        unreadEmails(i).UnRead = False
    Next
    
    'Set the unreadEmails collection to the unread emails in the archive folder
    Set unreadEmails = namespace.folders("danseethaler@ldschurch.org").folders("Archive").items.Restrict("[UnRead] = True")
    
    'Iterate through the emails in reverse and change the UnRead property to False
    For i = unreadEmails.Count To 1 Step -1
        unreadEmails(i).UnRead = False
    Next

End Sub
